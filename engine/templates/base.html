{% load static wagtailuserbar %}
{% load menu_tags %}
{% load engine_dashboard_tags %}

<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8" />
        <title>
            {% block title %}
                {% if self.seo_title %}{{ self.seo_title }}{% else %}{{ self.title }}{% endif %}
            {% endblock %}
            {% block title_suffix %}
                {% with self.get_site.site_name as site_name %}
                    {% if site_name %}- {{ site_name }}{% endif %}
                {% endwith %}
            {% endblock %}
        </title>
        <meta name="description" content="{{ self.search_description }}" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Web Mastered Engine v{% get_engine_version %}" />
        <meta name=”robots” content="index, follow">

        {# Global stylesheets #}
        <link rel="stylesheet" type="text/css" href="{% static 'css/engine.css' %}">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

        {% block extra_css %}
            {# Override this in templates to add extra stylesheets #}
        {% endblock %}
    </head>

    <body class="{% block body_class %}{% endblock %}">
        {% wagtailuserbar %}

        <div class="container-fluid">
            <div class="heading-container row justify-content-center bg-gradient mb-5 pb-5">
                <div class="col-11 col-sm-9">
                    {% comment %} Menu goes here {% endcomment %}
                    {% main_menu apply_active_classes=True max_levels=1 add_sub_menus_inline=True template="menus/main_menu.html" %}
                    {% block heading %}{% endblock %}
                </div>
            </div>
            <div class="content-container row justify-content-center">
                <div class="col-11 col-sm-9">
                    {% block content %}{% endblock %}
                </div>
            </div>
        </div>

        {# Global javascript #}
        <script type="text/javascript" src="{% static 'js/engine.js' %}"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
        {% block extra_js %}
            {# Override this in templates to add extra javascript #}
        {% endblock %}
    </body>
</html>

<script>

function darkMode() {
    console.log('Currently in dark mode');
    $( "body" ).removeClass( "bg-light text-dark" );
    $( ".heading-container" ).removeClass( "bg-light text-dark" );
    $( ".content-container" ).removeClass( "bg-light text-dark" );
    $( ".heading-nav" ).removeClass( "navbar-light" );
    $( "body" ).addClass( "bg-dark text-light" );
    $( ".heading-container" ).addClass( "bg-dark text-light" );
    $( ".content-container" ).addClass( "bg-dark text-light" );
    $( ".heading-nav" ).addClass( "navbar-dark" );
}

function lightMode() {
    console.log('Currently in light mode');
    $( "body" ).removeClass( "bg-dark text-light" );
    $( ".heading-container" ).removeClass( "bg-dark text-light" );
    $( ".content-container" ).removeClass( "bg-dark text-light" );
    $( ".heading-nav" ).removeClass( "navbar-dark" );
    $( "body" ).addClass( "bg-light text-dark" );
    $( ".heading-container" ).addClass( "bg-light text-dark" );
    $( ".content-container" ).addClass( "bg-light text-dark" );
    $( ".heading-nav" ).addClass( "navbar-light" );
}

// Handle dark/light mode changes when user enters website
const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
if (prefersDarkScheme.matches) {
    darkMode();
} else {
    lightMode();
}

// Handle dark/light mode changes while user is on website
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
    if (event.matches) {
        darkMode();
  } else {
        lightMode();
    }
});

</script>
